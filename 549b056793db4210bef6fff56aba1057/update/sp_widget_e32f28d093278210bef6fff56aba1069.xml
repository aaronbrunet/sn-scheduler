<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function(spUtil,$scope) {
  /* widget controller */
  var c = this;

  spUtil.recordWatch($scope, $scope.data.constants.TABLE_TEAM_MEMBERS, "team=" + $scope.data.team_id);


};]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>on-call-team</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {
  
}]]></link>
        <name>On Call Schedule - Manage Team</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
	var ocu = new x_snc_on_call_sc_0.OnCallUtils();
	var constants = ocu.getConstants();
	data.constants = constants;
	var team_id = '-1';

	if($sp.getParameter('team')){
		team_id = $sp.getParameter('team');
	}
	var team = new GlideRecord(constants.TABLE_TEAMS);
	team.get(team_id);
	var team_roster = ocu.buildTeamRoster(team_id);
	//console.log(team_roster);
	data.team_roster = team_roster;
	data.team = team.getDisplayValue();

	for(var i in data.team_roster){
		var curr = data.team_roster[i];
		curr.tmForm = $sp.getForm(constants.TABLE_TEAM_MEMBERS, curr.id);
		curr.tmView = curr.tmForm._view;
		curr.tmModel = curr.tmForm._fields;
		if(curr.tmModel["user.phone"]){
			curr.userForm = $sp.getForm('sys_user',curr.user);
			curr.userView = curr.userForm._view;
			curr.userModel = curr.userForm._fields;
		}
		data.team_roster[i] = curr;
	}
	console.log(data.team_roster);

})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>aaron.brunet</sys_created_by>
        <sys_created_on>2024-07-18 02:13:09</sys_created_on>
        <sys_id>e32f28d093278210bef6fff56aba1069</sys_id>
        <sys_mod_count>33</sys_mod_count>
        <sys_name>On Call Schedule - Manage Team</sys_name>
        <sys_package display_value="On-Call Schedule" source="x_snc_on_call_sc_0">549b056793db4210bef6fff56aba1057</sys_package>
        <sys_policy/>
        <sys_scope display_value="On-Call Schedule">549b056793db4210bef6fff56aba1057</sys_scope>
        <sys_update_name>sp_widget_e32f28d093278210bef6fff56aba1069</sys_update_name>
        <sys_updated_by>aaron.brunet</sys_updated_by>
        <sys_updated_on>2024-07-18 03:29:50</sys_updated_on>
        <template><![CDATA[<div>
  <h1>Manage {{data.team}}</h1>
  
  <div ng-if="data.team_roster">
    <h2>Team Roster</h2>
    <div ng-repeat="m in data.team_roster">
      <div>{{m.name}} |
      <strong>Phone</strong>  <sp-editable-field editable-by-user="true" table="sys_user" table-id="m.user" field-model="m.userModel.phone"></sp-editable-field> |
{{m.role}}</div>
    </div>
  </div>
  
  
  
</div>]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>e32f28d093278210bef6fff56aba1069</id>
        <sys_created_by>aaron.brunet</sys_created_by>
        <sys_created_on>2024-07-18 02:13:09</sys_created_on>
        <sys_id>df6f60d093278210bef6fff56aba10ea</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>aaron.brunet</sys_updated_by>
        <sys_updated_on>2024-07-18 02:13:09</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
